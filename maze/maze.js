"use strict";function Maze(t){this.n=t.n,this.count=Math.pow(t.n,2),this.paths=Array(this.count),this.queue=Array(),this.delay=t.delay?t.delay:200,this.draw=t.draw,this.success=t.success||this.tip("找到出口了"),this.failed=t.failed||this.tip("迷宫无解"),this.startPos=0,this.stopPos=this.count-1}Maze.prototype={constructor:Maze,tip:function(t){return function(){alert(t)}},timer:null,genMaze:function(){for(var t=0;t<this.count;t++)this.paths[t]=this.startPos===t||this.stopPos===t||Math.random()<.5?0:1},start:function(){var t=this;t.genMaze(),t.curPos=t.startPos,t.findNext(),t.draw(),t.timer=setInterval(function(){t.findNext(),t.draw()},t.delay)},findNext:function(t){var s,i=this.curPos;if(0===this.paths[i]){if(this.queue.push({pos:i,di:0}),this.paths[i]=2,i===this.stopPos)return this.stop(),this.success();s=this.nextPos(i,0),null!=s&&(this.curPos=s)}else{var h=this.queue.pop();4===h.di?(this.paths[h.pos]=4,this.queue.length||(this.stop(),this.failed())):(h.di++,this.queue.push(h),s=this.nextPos(h.pos,h.di),null!=s&&(this.curPos=s))}},nextPos:function(t,s){if(0===s){if(this.n-1!==t%this.n)return++t}else if(1===s){if(this.n-1!==Math.floor(t/this.n))return t+this.n}else if(2===s){if(0!==t%this.n)return--t}else if(3===s&&t>=this.n)return t-this.n},restart:function(){this.stop(),this.start()},stop:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},clear:function(){for(var t=0;t<this.count;t++)this.paths[t]=0}};