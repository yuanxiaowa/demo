"use strict";function Sweeping(i){this.type=i.type,this.draw=i.draw,this.init=i.init,this.success=i.success||this.tip("闯关成功"),this.failed=i.failed||this.tip("挖着雷了")}Sweeping.EASY=0,Sweeping.MEDIUM=1,Sweeping.HARD=2,Sweeping.prototype={constructor:Sweeping,tip:function(i){return function(){alert(i)}},genBoard:function(){var i,s,t,n;for(this.type===Sweeping.MEDIUM?(i=16,s=40):this.type===Sweeping.HARD?(i=32,s=99):(i=8,s=10),t=Math.pow(i,2),this.n=i,this.remain=this.count=t,this.mines_count=s,n=this.mines=Array(s),this.boards=Array(t);s;)i=parseInt(Math.random()*t),-1===n.indexOf(i)&&(n[--s]=i);for(var h=0;t>h;h++){var e=n.indexOf(h)>-1?1:0;this.boards[h]={clicked:!1,signed:!1,isMine:e}}for(var h=0;t>h;h++){var r=this.boards[h];r.isMine||(r.num=this.getNum(h))}},getNum:function(i){var s=0,t=parseInt(i/this.n),n=i%this.n;return t>0&&(s+=this.boards[i-this.n].isMine,n>0&&(s+=this.boards[i-this.n-1].isMine),n<this.n-1&&(s+=this.boards[i-this.n+1].isMine)),t<this.n-1&&(s+=this.boards[i+this.n].isMine,n>0&&(s+=this.boards[i+this.n-1].isMine),n<this.n-1&&(s+=this.boards[i+this.n+1].isMine)),n>0&&(s+=this.boards[i-1].isMine),n<this.n-1&&(s+=this.boards[i+1].isMine),s},start:function(){this.isStart=!0,this.marked=0,this.init(),this.genBoard(),this.draw()},restart:function(){this.stop(),this.start()},stop:function(){this.isStart=!1},click:function(i){var s=this.boards[i];this.remain--,s.isMine?(this.stop(),this.failed()):(this.near(i),this.remain===this.mines_count&&(this.stop(),this.success())),this.draw()},near:function(i){var s=this.boards[i];if(!s.clicked&&(s.clicked=!0,s.signed&&(s.signed=!1,this.marked--),0===s.num)){var t=parseInt(i/this.n),n=i%this.n;t>0&&(this.near(i-this.n),n>0&&this.near(i-this.n-1),n<this.n-1&&this.near(i-this.n+1)),t<this.n-1&&(this.near(i+this.n),n>0&&this.near(i+this.n-1),n<this.n-1&&this.near(i+this.n+1)),n>0&&this.near(i-1),n<this.n-1&&this.near(i+1)}},sign:function(i){var s=this.boards[i];s.signed=!s.signed,s.signed?this.marked++:this.marked--}};